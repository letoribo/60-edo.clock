Meteor.startup(function (){

var Jazz = document.getElementById("Jazz");
Meteor.setInterval(function(){
  
  var Sec = ind[sec];
  var Min = ind[min];
  var Hour = ind[hour];
  //console.log(Sec);
  
  var note = chr[Sec].s;
  //var mn = chr[Min].s;
  var lsb = chr[Sec].l;
  var msb = chr[Sec].m;
  //console.log(note);
  //var MSB = 100/32;// 400/128   3.125 (цента на один бит 3-го байта)
 //var LSB = MSB/128;//0.0244140625 (цента на один бит 2-го байта)                51,70
  //console.log(Math.round(40 % MSB/LSB) + "," + (64 + Math.floor(40 / MSB))); // 102,76 
  //console.log(Math.round(60 % MSB/LSB) + "," + (64 + Math.floor(60 / MSB))); // 26,83 
  //console.log(Math.round(100 % MSB/LSB) + "," + (64 + Math.floor(100 / MSB))); // 77,89 
  
  exe(message,0xC0,45,0);
  exe(message,0xe0,lsb,msb);
  exe(message,0x90,chr[Sec].s,127);
  
  if (Sec == 0){
 	 console.log("Sec == 0");
 	 console.log(Min);
    
    exe(message,0xc1,95,0);
    exe(message,0xb1,121,0);
    exe(message,0xb1,123,0);
    exe(message,0xe1,chr[Min].l,chr[Min].m);
    exe(message,0x91,chr[Min].s,87);
    
    exe(message,0xc2,50,0);
    exe(message,0xb2,121,0);
    exe(message,0xb2,123,0);
    exe(message,0xe2,chr[Hour].l,chr[Hour].m);
    exe(message,0x92,chr[Hour].s,79);
  }
  Session.set('time', new Date);
}, 1000);

});

function message(x,y,z){
  Jazz.MidiOut(x,y,z);
}
function exe(some,x,y,z){
  some(x,y,z);
}

UI.body.helpers({
 
  hours: _.range(0, 12),

  degrees: function (){
    return 30 * this;
  },

  handData: function (){
    time = Session.get('time') || new Date;
    sec = time.getSeconds();
    min = time.getMinutes();
    hour = time.getHours();
    return {
    	Hours: hour, 
      hourDegrees: hour * 30,
      Minutes: min,
      minuteDegrees: min * 6,
      Seconds: sec,
      secondDegrees: sec * 6 };
  },

  radial: function (angleDegrees, startFraction, endFraction){
    var r = 100;
    var radians = (angleDegrees-90) / 180 * Math.PI;

    return {
      x1: r * startFraction * Math.cos(radians),
      y1: r * startFraction * Math.sin(radians),
      x2: r * endFraction * Math.cos(radians),
      y2: r * endFraction * Math.sin(radians)
    };
  }
});

$(function(){
  console.log("Hour is " + hour);
  $('.banner').unslider();
});

/*Meteor.setTimeout(func, 5000);
function func()
{  var Jazz = document.getElementById("Jazz");
   console.log(Jazz);
   Jazz.MidiOut(0x90,68,127);
}*/